# PROBLEM OF IDENTITY
  java provides the following method to check if two owners(o1 and o2) are the same or not:
  * The equals() method for checking the equality of two objects.
  * The == operator checks if two object references are denoting the same instance.


---

## ðŸ”¹ Problem of Identity

### In **Java / OOP**

* Two ways to check whether two objects are "the same":

1. **`==` operator** â†’ Checks **reference identity**

   ```java
   Owner o1 = new Owner(1, "Aashiq");
   Owner o2 = o1;
   System.out.println(o1 == o2); // true (same memory reference)
   ```

2. **`equals()` method** â†’ Checks **logical equality** (based on object state, e.g., IDs, fields)

   ```java
   Owner o1 = new Owner(1, "Aashiq");
   Owner o2 = new Owner(1, "Aashiq");
   System.out.println(o1.equals(o2)); // true (if equals() is overridden)
   System.out.println(o1 == o2);      // false (different objects in memory)
   ```

So in OOP, **identity can be reference-based or value-based**.

---

### In **RDBMS**

* Tables represent data in **rows**.
* Identity is determined **only by primary key**.

Example:

```sql
CREATE TABLE owner (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);
```

* Two rows with the same data but different IDs are considered **different**.
* If IDs match â†’ itâ€™s the **same entity**.
* Thereâ€™s no concept of object reference (`==`) in RDBMS.

---

## ðŸ”¹ The Mismatch

* In Java, you can have **two different objects** (different memory references) that represent the **same row** in the database.

Example:

```java
Owner o1 = ownerRepository.findById(1);
Owner o2 = ownerRepository.findById(1);

System.out.println(o1 == o2);     // false (different objects loaded separately)
System.out.println(o1.equals(o2)); // true (if equals() compares IDs)
```

ðŸ‘‰ Both represent the same **row in DB** (id = 1),
but in Java they are **different instances in memory**.

---

## ðŸ”¹ How Hibernate Solves It

Hibernate introduces the concept of a **Persistence Context (a.k.a. First-Level Cache)**:

* Within a **session**, Hibernate ensures that only **one object instance** exists for each database row (per primary key).

Example:

```java
Session session = sessionFactory.openSession();

Owner o1 = session.get(Owner.class, 1);
Owner o2 = session.get(Owner.class, 1);

System.out.println(o1 == o2); // true! (Hibernate returns the same instance)
```

âœ… Hibernate ensures **object identity in memory** matches **row identity in DB**.
âœ… No duplicate objects for the same primary key in a session.

---

## ðŸ”¹ Summary

* **Java:** Identity can be `==` (same memory reference) or `.equals()` (same state).
* **RDBMS:** Identity is **primary key** only.
* **Problem:** Same DB row can appear as multiple Java objects â†’ confusion.
* **Hibernateâ€™s fix:** Persistence Context ensures one instance per row per session, aligning object identity with DB identity.


